<div class="container-nearby-places">
  <div class="nearby-places-cards">
      <% nearby_places.each do |nearby_place| %>
        <div class="nearby-places-card">
          <div>
            <h5 class="mb-3"><%= nearby_place.name %></h5>
            <%= link_to "Appeler", "tel:#{nearby_place.tel}", class: "action-button" %>
            <%= link_to "Site web", nearby_place.website, class: "action-button", target: "_blank" %>
          </div>
          <%= image_tag place.illustration, class: "image-nearby-places" %>
        </div>
      <% end %>
  </div>

  <div id="map"></div>

  <script>
  mapboxgl.accessToken = 'pk.eyJ1IjoidnNjaG1pdHQiLCJhIjoiY2xwamdyd3RzMGI1dTJpcW9mMmp5MTZ4dCJ9.lrohzerGwUtMg0fiQmKs4Q';
  const monument = [<%=place.long%>, <%=place.lat %>];

  const map = new mapboxgl.Map({
  container: 'map',
  style: 'mapbox://styles/mapbox/streets-v12',
  center: monument,
  zoom: 15
  });

  <% nearby_places.each do |place| %>
    var marker = new mapboxgl.Marker()
      .setLngLat([<%=place.long%>, <%=place.lat%>])
      .setPopup(new mapboxgl.Popup().setHTML('<h3>' + '<%=place.name%>' + '</h3>'))
      .addTo(map);
  <% end %>
  </script>
</div>
